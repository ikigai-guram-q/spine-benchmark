import{_ as m,S as h,a as p}from"./SpineLoader-BheIgaS5.js";const u=document.getElementById("log"),w=document.getElementById("folder"),y=document.getElementById("download"),r=l=>{u.textContent+=l+`
`};let c=null;function b(l){var d;const a=l.map(e=>(e.webkitRelativePath||e.name).replace(/\\/g,"/")).map(e=>{const o=e.split("/").filter(Boolean);return o.pop(),o});let n=0;for(;;){const e=(d=a[0])==null?void 0:d[n];if(!e)break;if(a.every(o=>o[n]===e))n++;else break}const t={};for(let e=0;e<l.length;e++){const s=a[e][n];(t[s]??(t[s]=[])).push(l[e])}return t}function v(l,i="results.json"){const a=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),n=URL.createObjectURL(a),t=document.createElement("a");t.href=n,t.download=i,t.click(),URL.revokeObjectURL(n)}w.addEventListener("change",async l=>{const i=[...l.target.files];if(!i.length)return;u.textContent="",r(`Selected ${i.length} files`);const a=b(i),n=Object.keys(a).sort();r(`Found ${n.length} subfolders: ${n.join(", ")}`);let t=null;try{const e=await m(()=>import("./SpineLoader-BheIgaS5.js").then(o=>o.y),[]);t=new e.Application,document.body.appendChild(t.view),t.view.style.width="1px",t.view.style.height="1px",t.view.style.opacity="0",t.view.style.position="absolute"}catch{r("Could not create PIXI Application automatically. If loader needs it, we must use the repo's app.")}const d=new h(t);c={};for(const e of n){const o=a[e];r(`
[${e}] loading ${o.length} files...`);try{const s=await d.loadSpineFiles(o);if(!s){c[e]={error:"Failed to load spine"},r(`[${e}] ❌ failed to load`);continue}const f=p.analyze(s),g=p.exportJSON(f);c[e]=g,r(`[${e}] ✅ analyzed`)}catch(s){c[e]={error:String(s)},r(`[${e}] ❌ error: ${s}`)}}y.disabled=!1,r(`
Done. Click “Download results.json”.`)});y.addEventListener("click",()=>{c&&v(c,"results.json")});
